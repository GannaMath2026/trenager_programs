<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå≥ –î–µ—Ä–µ–≤–æ –§–∞–Ω–æ ‚Äî —Ç—Ä–µ–Ω–∞–∂—ë—Ä –ø–æ –∑–∞–¥–∞—á–∞–º</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .app {
            width: 100vw;
            height: 100vh;
            display: flex;
            overflow: hidden;
        }
        
        .left-panel {
            width: 420x;
            min-width: 400px;
            background: rgba(26, 32, 44, 0.98);
            backdrop-filter: blur(10px);
            color: white;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            box-shadow: 4px 0 15px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .left-panel h2 {
            margin: 0 0 10px 0;
            font-size: 1.6em;
            color: #e2e8f0;
            border-bottom: 2px solid #4a5568;
            padding-bottom: 8px;
        }
        
        .left-panel h3 {
            margin: 10px 0 5px 0;
            font-size: 1.2em;
            color: #a0aec0;
        }
        
        .task-full-description {
            background: #2d3748;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #667eea;
            max-height: 350px;
            overflow-y: auto;
            font-size: 1.05em;
            line-height: 1.6;
            color: #f0f4fa;
            white-space: pre-wrap;
            font-family: 'Segoe UI', sans-serif;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
            border: 1px solid #4a5568;
        }
        
        .task-list-container {
            background: #2d3748;
            border-radius: 12px;
            padding: 15px;
            max-height: 320px;
            overflow-y: auto;
            border: 1px solid #4a5568;
        }
        
        .task-item {
            padding: 14px 18px;
            margin-bottom: 8px;
            background: #4a5568;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
            font-size: 1.05em;
            border-left: 4px solid transparent;
        }
        
        .task-item:hover {
            background: #5f6b7a;
            transform: translateX(5px);
        }
        
        .task-item.active {
            background: #434190;
            border-left: 4px solid #fbbf24;
        }
        
        .task-name {
            font-weight: 600;
            white-space: normal;
            word-break: break-word;
            max-width: 260px;
        }
        
        .task-actions {
            display: flex;
            gap: 10px;
        }
        
        .task-actions button {
            padding: 5px 10px;
            font-size: 0.9em;
            background: #2d3748;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .task-actions button:hover {
            background: #1e293b;
            transform: scale(1.05);
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 6px;
            color: #cbd5e0;
            font-weight: 600;
            font-size: 1.05em;
        }
        
        .input-field {
            width: 100%;
            padding: 12px 15px;
            background: #2d3748;
            border: 2px solid #4a5568;
            border-radius: 10px;
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 1.05em;
            resize: vertical;
            transition: all 0.2s;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .btn {
            padding: 12px 18px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1em;
            flex: 1;
            min-width: 85px;
        }
        
        .btn-primary {
            background: #4299e1;
            color: white;
        }
        
        .btn-primary:hover {
            background: #3182ce;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .btn-success {
            background: #48bb78;
            color: white;
        }
        
        .btn-success:hover {
            background: #38a169;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #f56565;
            color: white;
        }
        
        .btn-danger:hover {
            background: #e53e3e;
            transform: translateY(-2px);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid #4a5568;
            color: #e2e8f0;
        }
        
        .btn-outline:hover {
            background: #4a5568;
        }
        
        .right-panel {
            flex: 1;
            min-width: 500px;
            background: #1a202c;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .task-header {
            padding: 15px 25px;
            background: #2d3748;
            color: white;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 5;
        }
        
        .task-header h1 {
            margin: 0;
            font-size: 1.5em;
            color: #e2e8f0;
            word-break: break-word;
        }
        
        .task-number {
            background: #4299e1;
            padding: 6px 18px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1.1em;
            white-space: nowrap;
        }
        
        .canvas-container {
            flex: 1;
            overflow: auto;
            position: relative;
            background: #1a202c;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .canvas-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: auto;
        }
        
        #treeCanvas {
            display: block;
            width: 100%;
            height: 100%;
            min-width: 1000px;
            min-height: 700px;
        }
        
        .zoom-panel {
            background: #2d3748;
            padding: 15px 25px;
            display: flex;
            gap: 15px;
            align-items: center;
            justify-content: center;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            z-index: 5;
            flex-wrap: wrap;
        }
        
        .zoom-panel .btn {
            flex: 0;
            min-width: 60px;
            padding: 10px 18px;
            font-size: 1.05em;
        }
        
        .zoom-panel span {
            color: #e2e8f0;
            font-size: 1.1em;
            background: #4a5568;
            padding: 6px 18px;
            border-radius: 30px;
        }
        
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: #2d3748;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #5a67d8;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="left-panel">
            <h2>üìö –ó–∞–¥–∞—á–∏ –ø–æ –§–∞–Ω–æ</h2>
            
            <div class="task-full-description" id="taskFullDescription">
                –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞—á—É –∏–∑ —Å–ø–∏—Å–∫–∞
            </div>
            
            <div class="button-group">
                <button class="btn btn-success" onclick="newTask()">‚ûï –ù–æ–≤–∞—è</button>
                <button class="btn btn-outline" onclick="exportTasks()">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
                <button class="btn btn-outline" onclick="importTasks()">üì• –ò–º–ø–æ—Ä—Ç</button>
            </div>
            
            <h3>üìã –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</h3>
            <div class="task-list-container">
                <div id="taskList"></div>
            </div>
            
            <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä</h3>
            <div class="input-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
                <input type="text" id="taskName" class="input-field" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–æ–¥—ã —Å –§–∞–Ω–æ">
            </div>
            
            <div class="input-group">
                <label>–ö–æ–¥—ã (—Ñ–æ—Ä–º–∞—Ç: –ê=0, –ë=10, ...)</label>
                <textarea id="codesInput" class="input-field" rows="4" placeholder="–ê=0
–ë=10
–í=110
–ì=111"></textarea>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="saveTask()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn btn-danger" onclick="deleteTask()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="right-panel">
            <div class="task-header">
                <div class="task-number" id="currentTaskId">#0</div>
                <h1 id="currentTaskTitle">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
            </div>
            
            <div class="canvas-container">
                <div class="canvas-wrapper">
                    <canvas id="treeCanvas" width="1200" height="800"></canvas>
                </div>
            </div>
            
            <div class="zoom-panel">
                <button class="btn btn-primary" onclick="zoomIn()">‚ûï</button>
                <button class="btn btn-primary" onclick="zoomOut()">‚ûñ</button>
                <button class="btn btn-primary" onclick="resetZoom()">üîÑ –°–±—Ä–æ—Å</button>
                <button class="btn btn-primary" onclick="fitToScreen()">‚§¢ –ü–æ —Ä–∞–∑–º–µ—Ä—É</button>
                <span id="zoomLevel">100%</span>
            </div>
        </div>
    </div>

    <script>
        // ========== –ö–õ–ê–°–° –£–ó–õ–ê ==========
        class Node {
            constructor(name = null) {
                this.name = name;
                this.left = null;
                this.right = null;
                this.code = ""; // –ø–æ–ª–Ω—ã–π –∫–æ–¥ –æ—Ç –∫–æ—Ä–Ω—è –¥–æ —ç—Ç–æ–≥–æ —É–∑–ª–∞
                this.x = 0;
                this.y = 0;
            }
        }

        // ========== –î–ê–ù–ù–´–ï ==========
        let tasks = [];
        let currentTaskId = null;
        let root = null;
        
        const canvas = document.getElementById('treeCanvas');
        const ctx = canvas.getContext('2d');
        
        let scale = 1;
        let offsetX = 0;
        let offsetY = 0;
        let isDragging = false;
        let dragStartX, dragStartY;

        // ========== –ó–ê–ì–†–£–ó–ö–ê –ó–ê–î–ê–ß ==========
        function loadTasksFromJSON() {
            tasks = [
                {
                    "id": 1,
                    "name": "–î–ï–ú–û 2024 (–ø—Ä–∞–∫—Ç–∏–∫–∞)",
                    "fullDescription": "–î–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ—Å—Ç–æ—è—â–µ–π –∏–∑ –±—É–∫–≤ –ê, –ë, –í, –ì, –î, –ï, —Ä–µ—à–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–π –¥–≤–æ–∏—á–Ω—ã–π –∫–æ–¥, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏–π —É—Å–ª–æ–≤–∏—é –§–∞–Ω–æ. –î–ª—è –±—É–∫–≤ –∏–∑–≤–µ—Å—Ç–Ω—ã –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞: –ê=000, –ë=001, –í=0101, –ì=0100, –î=011, –ï=101. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.",
                    "codes": { "–ê": "000", "–ë": "001", "–í": "0101", "–ì": "0100", "–î": "011", "–ï": "101" }
                },
                {
                    "id": 2,
                    "name": "6810 - –±—É–∫–≤–∞ X",
                    "fullDescription": "–ü–æ –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Ç–æ–ª—å–∫–æ –¥–≤–µ–Ω–∞–¥—Ü–∞—Ç—å –±—É–∫–≤: –ê, –í, –°, –ï, –ù, –ö, –ú, –û, –†, –¢, X, Y. –î–ª—è –¥–µ—Å—è—Ç–∏ –±—É–∫–≤ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã: –ê=0, –í=1, –°=00, –ï=01, –ù=10, –ö=11, –ú=000, –û=001, –†=010, –¢=011. –£–∫–∞–∂–∏—Ç–µ –∫—Ä–∞—Ç—á–∞–π—à–µ–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –±—É–∫–≤—ã X, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∫–æ–¥ –±—É–¥–µ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å —É—Å–ª–æ–≤–∏—é –§–∞–Ω–æ. –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –∫–æ–¥–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ, —É–∫–∞–∂–∏—Ç–µ –∫–æ–¥ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º —á–∏—Å–ª–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.",
                    "codes": { "–ê": "0", "–í": "1", "–°": "00", "–ï": "01", "–ù": "10", "–ö": "11", "–ú": "000", "–û": "001", "–†": "010", "–¢": "011" }
                },
                {
                    "id": 3,
                    "name": "5851 - –±—É–∫–≤–∞ –°",
                    "fullDescription": "–ü–æ –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–∏–º–≤–æ–ª—ã: –ê, –í, –ï, –õ, –ò, –ù, –û, –°, –£, –§ –∏ –ø—Ä–æ–±–µ–ª. –ö–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—É–∫–≤ –∏–∑–≤–µ—Å—Ç–Ω—ã: –û=0000, –£=10, –ê=0001, –ò=1101, –í=0010, –ù=11001, –ï=0011, –§=110001. –£–∫–∞–∂–∏—Ç–µ –∫–æ–¥ –¥–ª—è –±—É–∫–≤—ã –° —Ç–∞–∫–æ–π, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ –£–°–õ–û–í–ò–ï –§–ê–ù–û –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞–∏–º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –±–∏—Ç. –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –∫–æ–¥–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ, —É–∫–∞–∂–∏—Ç–µ –∫–æ–¥ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º —á–∏—Å–ª–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.",
                    "codes": { "–û": "0000", "–£": "10", "–ê": "0001", "–ò": "1101", "–í": "0010", "–ù": "11001", "–ï": "0011", "–§": "110001" }
                },
                {
                    "id": 4,
                    "name": "6433 - –±—É–∫–≤–∞ –Ø",
                    "fullDescription": "–í—Å–µ –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã —Ä—É—Å—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º –¥–≤–æ–∏—á–Ω—ã–º –∫–æ–¥–æ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∏–∫–∞–∫–æ–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—á–∞–ª–æ–º –¥—Ä—É–≥–æ–≥–æ –∫–æ–¥–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞. –ö–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—É–∫–≤ –∏–∑–≤–µ—Å—Ç–Ω—ã: –ê=10, –ë=110, –í=01, –ì=001, –î=111. –£–∫–∞–∂–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω—ã–π –∫–æ–¥ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã –¥–ª—è –±—É–∫–≤—ã –Ø. –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –∫–æ–¥–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ, —É–∫–∞–∂–∏—Ç–µ —Ç–æ—Ç –∏–∑ –Ω–∏—Ö, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.",
                    "codes": { "–ê": "10", "–ë": "110", "–í": "01", "–ì": "001", "–î": "111" }
                },
                {
                    "id": 5,
                    "name": "6274 - –ö–ê–ü–ò–ë–ê–†–ê",
                    "fullDescription": "–î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–ª–æ–≤ –ø–æ –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —à–∏—Ñ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ —É—Å–ª–æ–≤–∏—é –§–∞–Ω–æ. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±—É–∫–≤—ã, –≤–∑—è—Ç—ã–µ –∏–∑ –Ω–∞–±–æ—Ä–∞ –ö, –†, –ë, –ê, –ò, –ü, –ø—Ä–∏—á–µ–º –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –ª—é–±–æ–π –≥–ª–∞—Å–Ω–æ–π –±—É–∫–≤—ã –∫–æ—Ä–æ—á–µ, —á–µ–º –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –ª—é–±–æ–π —Å–æ–≥–ª–∞—Å–Ω–æ–π. –ë—É–∫–≤—ã –†, –ë, –ü, –ò –∏–º–µ—é—Ç –∫–æ–¥ 111, 110, 101 –∏ 00 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ó–∞–ø–∏—à–∏—Ç–µ —Å–ª–æ–≤–æ, –∫–æ–¥ –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–º–µ–µ—Ç –≤–∏–¥ 10001101001100111101.",
                    "codes": { "–†": "111", "–ë": "110", "–ü": "101", "–ò": "00" }
                },
                {
                    "id": 6,
                    "name": "6371 - –ì–†–ê–ù–ê–¢",
                    "fullDescription": "–í—Å–µ –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã —Ä—É—Å—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º –¥–≤–æ–∏—á–Ω—ã–º –∫–æ–¥–æ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∏–∫–∞–∫–æ–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—á–∞–ª–æ–º –¥—Ä—É–≥–æ–≥–æ –∫–æ–¥–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ —Å–ª–æ–≤–æ –ì–†–ê–ù–ê–¢ –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ 0101110100101100. –î–ª–∏–Ω–∞ –≤—Å–µ—Ö –∫–æ–¥–æ–≤—ã—Ö —Å–ª–æ–≤ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 3. –ö–∞–∫–æ–π –∫–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ª–æ–≤—É –¢–†–ù?",
                    "codes": { "–ì": "010", "–†": "111", "–ê": "0100", "–ù": "1010", "–¢": "1100" }
                },
                {
                    "id": 7,
                    "name": "6531 - –ü–û–¢–û–ö",
                    "fullDescription": "–í—Å–µ –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã —Ä—É—Å—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º –¥–≤–æ–∏—á–Ω—ã–º –∫–æ–¥–æ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∏–∫–∞–∫–æ–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—á–∞–ª–æ–º –¥—Ä—É–≥–æ–≥–æ –∫–æ–¥–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ —Å–ª–æ–≤–æ –ü–û–¢–û–ö –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ 10001100011. –ö–∞–∫–æ–π –∫–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ª–æ–≤—É –ö–û–¢?",
                    "codes": { "–ü": "100", "–û": "011", "–¢": "000", "–ö": "11" }
                },
                {
                    "id": 8,
                    "name": "5122 - –ë–ê–†–ê–ë–ê–°",
                    "fullDescription": "–î–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ—Å—Ç–æ—è—â–µ–π –∏–∑ –±—É–∫–≤ –ê, –ë, –ö, –†, C, –¢ —Ä–µ—à–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–π –¥–≤–æ–∏—á–Ω—ã–π –∫–æ–¥, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ –§–∞–Ω–æ. –î–ª—è –±—É–∫–≤ –ë –∏ –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ 000, 01. –ù–∞–π–¥–∏—Ç–µ –∫–æ–¥–æ–≤—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∏–º–µ–Ω—å—à–µ–π –¥–ª–∏–Ω—ã –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–≤–∞ –ë–ê–†–ê–ë–ê–° –∏ –∑–∞–ø–∏—à–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–æ—Å—å–º–µ—Ä–∏—á–Ω–æ–º –∫–æ–¥–µ. –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –∫–æ–¥–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ, —É–∫–∞–∂–∏—Ç–µ –∫–æ–¥ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º —á–∏—Å–ª–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.",
                    "codes": { "–ë": "000", "–°": "01" }
                },
                {
                    "id": 9,
                    "name": "5121 - –ö–û–õ–û–ö–û–õ",
                    "fullDescription": "–î–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ—Å—Ç–æ—è—â–µ–π –∏–∑ –±—É–∫–≤ –ê, –ö, –õ, –û, C, –¢ —Ä–µ—à–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–π –¥–≤–æ–∏—á–Ω—ã–π –∫–æ–¥, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ –§–∞–Ω–æ. –î–ª—è –±—É–∫–≤ –ê –∏ –ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ 10, 111. –ù–∞–π–¥–∏—Ç–µ –∫–æ–¥–æ–≤—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∏–º–µ–Ω—å—à–µ–π –¥–ª–∏–Ω—ã –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–≤–∞ –ö–û–õ–û–ö–û–õ –∏ –∑–∞–ø–∏—à–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–æ—Å—å–º–µ—Ä–∏—á–Ω–æ–º –∫–æ–¥–µ. –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –∫–æ–¥–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ, —É–∫–∞–∂–∏—Ç–µ –∫–æ–¥ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º —á–∏—Å–ª–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.",
                    "codes": { "–ê": "10", "–ö": "111" }
                },
                {
                    "id": 10,
                    "name": "6987 - —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –†",
                    "fullDescription": "–ü–æ –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Ç–æ–ª—å–∫–æ —Å–µ–º—å –±—É–∫–≤: –†, –ï, –ö, –£, –°, –ò, –Ø. –ö–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –±—É–∫–≤ –∏–∑–≤–µ—Å—Ç–Ω—ã: –†=1001, –ï=1010, –ö=1011, –£=1100, –°=1101, –ò=1110, –Ø=1111. –ö–∞–∫ –º–æ–∂–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –∫–æ–¥ –¥–ª—è –±—É–∫–≤—ã –†, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è–ª–æ—Å—å —Å–≤–æ–π—Å—Ç–≤–æ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è? –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –∫–æ–¥–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ —É–∫–∞–∑–∞—Ç—å –∫–æ–¥ –Ω–∞–∏–º–µ–Ω—å—à–µ–π –¥–ª–∏–Ω—ã.",
                    "codes": { "–†": "1001", "–ï": "1010", "–ö": "1011", "–£": "1100", "–°": "1101", "–ò": "1110", "–Ø": "1111" }
                },
                {
                    "id": 11,
                    "name": "3503 - —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –ù",
                    "fullDescription": "–ü–æ –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Ç–æ–ª—å–∫–æ —à–µ—Å—Ç—å –±—É–∫–≤: –¢, –ï, –ù, –°, –ò, –í. –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–æ–∏—á–Ω—ã–π –∫–æ–¥, –¥–æ–ø—É—Å–∫–∞—é—â–∏–π –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ö–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –±—É–∫–≤ –∏–∑–≤–µ—Å—Ç–Ω—ã: –¢=010, –ï=0100, –ù=1100, –°=01000, –ò=0110, –í=1110. –ö–∞–∫ –º–æ–∂–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –∫–æ–¥ –¥–ª—è –±—É–∫–≤—ã –ù, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è–ª–æ—Å—å —Å–≤–æ–π—Å—Ç–≤–æ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è? –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –∫–æ–¥–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ —É–∫–∞–∑–∞—Ç—å –∫–æ–¥ –Ω–∞–∏–º–µ–Ω—å—à–µ–π –¥–ª–∏–Ω—ã.",
                    "codes": { "–¢": "010", "–ï": "0100", "–ù": "1100", "–°": "01000", "–ò": "0110", "–í": "1110" }
                },
                {
                    "id": 12,
                    "name": "130 - —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –î",
                    "fullDescription": "–î–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ—Å—Ç–æ—è—â–µ–π –∏–∑ –±—É–∫–≤ –ê, –ë, –í, –ì –∏ –î, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–π –¥–≤–æ–∏—á–Ω—ã–π –∫–æ–¥, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—É—é –¥–≤–æ–∏—á–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –í–æ—Ç —ç—Ç–æ—Ç –∫–æ–¥: –ê=10, –ë=11, –í=000, –ì=001, –î=010. –ö–∞–∫ –º–æ–∂–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –¥–ª–∏–Ω—É –∫–æ–¥–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞ –¥–ª—è –±—É–∫–≤—ã –î —Ç–∞–∫, —á—Ç–æ–±—ã –∫–æ–¥ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –º–æ–∂–Ω–æ –±—ã–ª–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ? –ö–æ–¥—ã –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –±—É–∫–≤ –º–µ–Ω—è—Ç—å—Å—è –Ω–µ –¥–æ–ª–∂–Ω—ã. –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.",
                    "codes": { "–ê": "10", "–ë": "11", "–í": "000", "–ì": "001", "–î": "010" }
                },
                {
                    "id": 13,
                    "name": "128 - —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –ë",
                    "fullDescription": "–î–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ—Å—Ç–æ—è—â–µ–π –∏–∑ –±—É–∫–≤ –ê, –ë, –í, –ì –∏ –î, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–π –¥–≤–æ–∏—á–Ω—ã–π –∫–æ–¥, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—É—é –¥–≤–æ–∏—á–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –í–æ—Ç —ç—Ç–æ—Ç –∫–æ–¥: –ê=00, –ë=101, –í=011, –ì=111, –î=110. –ö–∞–∫ –º–æ–∂–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –¥–ª–∏–Ω—É –∫–æ–¥–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞ –¥–ª—è –±—É–∫–≤—ã –ë —Ç–∞–∫, —á—Ç–æ–±—ã –∫–æ–¥ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –º–æ–∂–Ω–æ –±—ã–ª–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ? –ö–æ–¥—ã –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –±—É–∫–≤ –º–µ–Ω—è—Ç—å—Å—è –Ω–µ –¥–æ–ª–∂–Ω—ã. –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.",
                    "codes": { "–ê": "00", "–ë": "101", "–í": "011", "–ì": "111", "–î": "110" }
                },
                {
                    "id": 14,
                    "name": "19408 - –°–ï–†–ü–ê–ù–¢–ò–ù",
                    "fullDescription": "–ü–æ –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Ç–æ–ª—å–∫–æ 8 –±—É–∫–≤: –ê, –ï, –ò, –ù, –ü, –†, –°, –¢. –ò–∑–≤–µ—Å—Ç–Ω—ã –∫–æ–¥—ã: –°=00, –ï=010, –†=011, –ê=1010, –¢=1011. –£–∫–∞–∂–∏—Ç–µ, –∫–∞–∫–æ–µ –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–≤–æ–∏—á–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è, —á—Ç–æ–±—ã –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–≤–æ –°–ï–†–ü–ê–ù–¢–ò–ù.",
                    "codes": { "–°": "00", "–ï": "010", "–†": "011", "–ê": "1010", "–¢": "1011" }
                },
                {
                    "id": 15,
                    "name": "18944 - –¢–´–ö–û–¢–ò–ö",
                    "fullDescription": "–î–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ—Å—Ç–æ—è—â–µ–π –∏–∑ –±—É–∫–≤ –¢, –´, –ö, –û, –ò —Ä–µ—à–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–π –¥–≤–æ–∏—á–Ω—ã–π –∫–æ–¥, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏–π —É—Å–ª–æ–≤–∏—é –§–∞–Ω–æ. –î–ª—è –±—É–∫–≤ –¢ –∏ –û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ 1111 –∏ 1010 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ö–∞–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–≤–æ–∏—á–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–≤–∞ –¢–´–ö–û–¢–ò–ö, –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –æ–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–≤–æ–∏—á–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ –∏ –ø—Ä–∏ —ç—Ç–æ–º –∫–∞–∂–¥–æ–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ —Å–æ–¥–µ—Ä–∂–∏—Ç —á—ë—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü?",
                    "codes": { "–¢": "1111", "–û": "1010" }
                }
            ];
        }

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        function init() {
            loadTasksFromJSON();
            currentTaskId = 1;
            renderTaskList();
            loadTask(1);
            
            canvas.addEventListener('mousedown', startDrag);
            canvas.addEventListener('mousemove', drag);
            canvas.addEventListener('mouseup', endDrag);
            canvas.addEventListener('mouseleave', endDrag);
            canvas.addEventListener('click', onClick);
        }

        // ========== –†–ê–ë–û–¢–ê –° –ó–ê–î–ê–ß–ê–ú–ò ==========
        function renderTaskList() {
            const list = document.getElementById('taskList');
            list.innerHTML = '';
            
            tasks.forEach(task => {
                const div = document.createElement('div');
                div.className = `task-item ${task.id === currentTaskId ? 'active' : ''}`;
                div.innerHTML = `
                    <span class="task-name" onclick="loadTask(${task.id})">${task.id}. ${task.name}</span>
                    <div class="task-actions">
                        <button onclick="editTask(${task.id})">‚úèÔ∏è</button>
                        <button onclick="deleteTask(${task.id})">üóëÔ∏è</button>
                    </div>
                `;
                list.appendChild(div);
            });
        }

        function loadTask(id) {
            const task = tasks.find(t => t.id === id);
            if (!task) return;
            
            currentTaskId = id;
            document.getElementById('taskName').value = task.name;
            document.getElementById('codesInput').value = formatCodesForInput(task.codes);
            document.getElementById('currentTaskId').textContent = `#${id}`;
            document.getElementById('currentTaskTitle').textContent = task.name;
            document.getElementById('taskFullDescription').innerHTML = task.fullDescription || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è';
            
            buildTreeFromCodes(task.codes);
            renderTaskList();
        }

        function saveTask() {
            const name = document.getElementById('taskName').value.trim();
            const input = document.getElementById('codesInput').value;
            
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏');
                return;
            }
            
            const codes = parseCodes(input);
            
            if (currentTaskId && currentTaskId <= 15) {
                alert('–ù–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é.');
                return;
            }
            
            if (currentTaskId) {
                const task = tasks.find(t => t.id === currentTaskId);
                if (task) {
                    task.name = name;
                    task.codes = codes;
                    task.fullDescription = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞';
                }
            } else {
                const newId = Math.max(...tasks.map(t => t.id), 15) + 1;
                tasks.push({ 
                    id: newId, 
                    name, 
                    codes,
                    fullDescription: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞'
                });
                currentTaskId = newId;
            }
            
            renderTaskList();
            loadTask(currentTaskId);
        }

        function newTask() {
            currentTaskId = null;
            document.getElementById('taskName').value = '';
            document.getElementById('codesInput').value = '–ê=0\n–ë=10\n–í=110\n–ì=111';
            document.getElementById('currentTaskId').textContent = '#–Ω–æ–≤–∞—è';
            document.getElementById('currentTaskTitle').textContent = '–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞';
            document.getElementById('taskFullDescription').innerHTML = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞';
            root = null;
            drawCanvas();
            renderTaskList();
        }

        function editTask(id) {
            if (id <= 15) {
                alert('–ù–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ø–∏—é.');
                return;
            }
            loadTask(id);
        }

        function deleteTask(id) {
            if (id <= 15) {
                alert('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏');
                return;
            }
            
            if (confirm(`–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É #${id}?`)) {
                tasks = tasks.filter(t => t.id !== id);
                if (currentTaskId === id) {
                    currentTaskId = 1;
                    loadTask(1);
                }
                renderTaskList();
            }
        }

        // ========== –ò–ú–ü–û–†–¢/–≠–ö–°–ü–û–†–¢ ==========
        function exportTasks() {
            const dataStr = JSON.stringify(tasks, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'fano_tasks.json';
            a.click();
            
            URL.revokeObjectURL(url);
        }

        function importTasks() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(ev) {
                    try {
                        const imported = JSON.parse(ev.target.result);
                        if (Array.isArray(imported)) {
                            tasks = imported;
                            currentTaskId = tasks[0]?.id || null;
                            if (currentTaskId) loadTask(currentTaskId);
                            renderTaskList();
                        } else {
                            alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞');
                        }
                    } catch (err) {
                        alert('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: ' + err);
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        // ========== –ü–ê–†–°–ò–ù–ì ==========
        function parseCodes(input) {
            const codes = {};
            const lines = input.split('\n').filter(line => line.trim() !== '');
            
            for (let line of lines) {
                const parts = line.split('=').map(s => s.trim());
                if (parts.length === 2 && parts[0] && parts[1]) {
                    codes[parts[0]] = parts[1];
                }
            }
            
            return codes;
        }

        function formatCodesForInput(codes) {
            return Object.entries(codes).map(([k, v]) => `${k}=${v}`).join('\n');
        }

        // ========== –ü–û–°–¢–†–û–ï–ù–ò–ï –î–ï–†–ï–í–ê ==========
        function buildTreeFromCodes(codes) {
            root = new Node();
            
            for (let [letter, code] of Object.entries(codes)) {
                let current = root;
                for (let bit of code) {
                    if (bit === '0') {
                        if (!current.left) current.left = new Node();
                        current = current.left;
                    } else {
                        if (!current.right) current.right = new Node();
                        current = current.right;
                    }
                    current.code += bit;
                }
                current.name = letter;
            }
            
            calculatePositions(root, 600, 50);
            setTimeout(() => fitToScreen(), 50);
        }

        function calculatePositions(node, x, y, level = 0) {
            if (!node) return;
            
            node.x = x;
            node.y = y;
            
            const offset = 100 / Math.pow(1.3, level);
            
            if (node.left) calculatePositions(node.left, x - offset, y + 80, level + 1);
            if (node.right) calculatePositions(node.right, x + offset, y + 80, level + 1);
        }

        // ========== –û–¢–†–ò–°–û–í–ö–ê ==========
        function drawCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (!root) return;
            
            ctx.save();
            ctx.translate(offsetX, offsetY);
            ctx.scale(scale, scale);
            
            drawEdges(root);
            drawNodes(root);
            
            ctx.restore();
            
            document.getElementById('zoomLevel').textContent = Math.round(scale * 100) + '%';
        }

        function drawEdges(node) {
            if (!node) return;
            
            ctx.beginPath();
            ctx.strokeStyle = '#4a5568';
            ctx.lineWidth = 2 / scale;
            
            if (node.left) {
                ctx.moveTo(node.x, node.y);
                ctx.lineTo(node.left.x, node.left.y);
                ctx.stroke();
                
                ctx.fillStyle = '#4299e1';
                ctx.font = `${16 / scale}px monospace`;
                ctx.fillText('0', (node.x + node.left.x) / 2 - 5, (node.y + node.left.y) / 2 - 10);
                
                drawEdges(node.left);
            }
            
            if (node.right) {
                ctx.moveTo(node.x, node.y);
                ctx.lineTo(node.right.x, node.right.y);
                ctx.stroke();
                
                ctx.fillStyle = '#4299e1';
                ctx.font = `${16 / scale}px monospace`;
                ctx.fillText('1', (node.x + node.right.x) / 2 + 5, (node.y + node.right.y) / 2 - 10);
                
                drawEdges(node.right);
            }
        }

        function drawNodes(node) {
            if (!node) return;
            
            const radius = node.name ? 22 : 16;
            const color = node.name ? '#f56565' : '#48bb78';
            
            ctx.beginPath();
            ctx.fillStyle = color;
            ctx.arc(node.x, node.y, radius / scale, 0, 2 * Math.PI);
            ctx.fill();
            ctx.strokeStyle = node.name ? '#c53030' : '#2f855a';
            ctx.lineWidth = 2 / scale;
            ctx.stroke();
            
            if (node.name) {
                ctx.fillStyle = 'white';
                ctx.font = `bold ${18 / scale}px Arial`;
                ctx.fillText(node.name, node.x - 9/scale, node.y + 7/scale);
            }
            
            if (node.code) {
                ctx.fillStyle = '#e2e8f0';
                ctx.font = `${13 / scale}px monospace`;
                const textWidth = ctx.measureText(node.code).width;
                ctx.fillText(node.code, node.x - textWidth/2, node.y + 40/scale);
            }
            
            drawNodes(node.left);
            drawNodes(node.right);
        }

        // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ú–ê–°–®–¢–ê–ë–û–ú ==========
        function zoomIn() {
            scale = Math.min(scale + 0.2, 3);
            drawCanvas();
        }

        function zoomOut() {
            scale = Math.max(scale - 0.2, 0.3);
            drawCanvas();
        }

        function resetZoom() {
            scale = 1;
            offsetX = 0;
            offsetY = 0;
            drawCanvas();
        }

        function fitToScreen() {
            if (!root) return;
            
            let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity;
            
            function findBounds(node) {
                if (!node) return;
                minX = Math.min(minX, node.x);
                maxX = Math.max(maxX, node.x);
                minY = Math.min(minY, node.y);
                maxY = Math.max(maxY, node.y);
                findBounds(node.left);
                findBounds(node.right);
            }
            
            findBounds(root);
            
            const padding = 100;
            const treeWidth = maxX - minX + padding * 2;
            const treeHeight = maxY - minY + padding * 2;
            
            const scaleX = canvas.width / treeWidth;
            const scaleY = canvas.height / treeHeight;
            
            scale = Math.min(scaleX, scaleY) * 0.9;
            
            offsetX = (canvas.width / 2) - (minX + maxX) / 2 * scale;
            offsetY = (canvas.height / 2) - (minY + maxY) / 2 * scale;
            
            drawCanvas();
        }

        // ========== –ü–ï–†–ï–ú–ï–©–ï–ù–ò–ï ==========
        function startDrag(e) {
            isDragging = true;
            dragStartX = e.clientX - offsetX;
            dragStartY = e.clientY - offsetY;
        }

        function drag(e) {
            if (!isDragging) return;
            offsetX = e.clientX - dragStartX;
            offsetY = e.clientY - dragStartY;
            drawCanvas();
        }

        function endDrag() {
            isDragging = false;
        }

        // ========== –ö–õ–ò–ö –ü–û –£–ó–õ–£ ==========
        function onClick(e) {
            if (!root) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left - offsetX) / scale;
            const y = (e.clientY - rect.top - offsetY) / scale;
            
            function findNode(node) {
                if (!node) return null;
                const dx = node.x - x;
                const dy = node.y - y;
                const dist = Math.sqrt(dx*dx + dy*dy);
                
                if (dist < 25) return node;
                return findNode(node.left) || findNode(node.right);
            }
            
            const clickedNode = findNode(root);
            if (clickedNode) {
                if (clickedNode.name) {
                    alert(`üìù –ë—É–∫–≤–∞: ${clickedNode.name}\n–ü–æ–ª–Ω—ã–π –∫–æ–¥: ${clickedNode.code}`);
                } else {
                    alert(`üîµ –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —É–∑–µ–ª\n–ü–æ–ª–Ω—ã–π –∫–æ–¥: ${clickedNode.code || '–∫–æ—Ä–µ–Ω—å'}`);
                }
            }
        }

        window.onload = init;
    </script>
</body>
</html>