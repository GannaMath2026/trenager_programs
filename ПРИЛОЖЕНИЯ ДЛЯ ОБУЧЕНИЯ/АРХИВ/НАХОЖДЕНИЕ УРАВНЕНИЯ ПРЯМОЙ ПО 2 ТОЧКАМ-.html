<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü—Ä—è–º–∞—è –ø–æ –¥–≤—É–º —Ç–æ—á–∫–∞–º</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 20px;
        }
        .container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 25px;
            max-width: 750px;
            width: 100%;
        }
        h2 {
            margin: 0 0 20px;
            color: #1e293b;
            text-align: center;
            font-weight: 500;
        }
        .points {
            display: flex;
            gap: 25px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .point {
            background-color: #f1f5f9;
            border-radius: 10px;
            padding: 15px;
            flex: 1;
            min-width: 200px;
        }
        .point h3 {
            margin: 0 0 12px;
            font-size: 1.1rem;
            color: #0f172a;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .point label {
            display: block;
            margin: 8px 0;
            color: #334155;
        }
        .point input {
            width: 90px;
            padding: 6px 10px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-size: 1rem;
            margin-left: 8px;
        }
        button {
            background-color: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 28px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: block;
            margin: 0 auto 25px;
            transition: background 0.2s;
            box-shadow: 0 4px 6px rgba(59,130,246,0.3);
        }
        button:hover {
            background-color: #2563eb;
        }
        .result {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 18px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
        }
        .result div {
            margin: 8px 0;
        }
        .formula {
            color: #1e293b;
            font-weight: 600;
        }
        .system {
            color: #0f172a;
            background-color: #e6f7ff;
            padding: 10px;
            border-radius: 6px;
            border-left: 4px solid #3b82f6;
        }
        canvas {
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            display: block;
            margin: 0 auto;
            background-color: white;
            width: 100%;
            height: auto;
            max-width: 450px;
        }
        .info {
            color: #64748b;
            font-size: 0.85rem;
            text-align: center;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>üìê –ü—Ä—è–º–∞—è —á–µ—Ä–µ–∑ –¥–≤–µ —Ç–æ—á–∫–∏</h2>
        <div class="points">
            <div class="point">
                <h3>üî¥ –¢–æ—á–∫–∞ A</h3>
                <label>x‚ÇÅ: <input type="number" id="x1" value="2" step="any"></label>
                <label>y‚ÇÅ: <input type="number" id="y1" value="3" step="any"></label>
            </div>
            <div class="point">
                <h3>üîµ –¢–æ—á–∫–∞ B</h3>
                <label>x‚ÇÇ: <input type="number" id="x2" value="5" step="any"></label>
                <label>y‚ÇÇ: <input type="number" id="y2" value="7" step="any"></label>
            </div>
        </div>
        <button id="calcBtn">‚ü≥ –í—ã—á–∏—Å–ª–∏—Ç—å –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å</button>

        <div class="result" id="result">
            <div class="formula" id="general">–£—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä—è–º–æ–π –≤ –æ–±—â–µ–º –≤–∏–¥–µ: y = k¬∑x + b</div>
            <div class="system" id="substitution">
                –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ—á–∫–∏:<br>
                <span id="point1">y‚ÇÅ = k¬∑x‚ÇÅ + b  ‚Üí  3 = k¬∑2 + b</span><br>
                <span id="point2">y‚ÇÇ = k¬∑x‚ÇÇ + b  ‚Üí  7 = k¬∑5 + b</span>
            </div>
            <div id="systemEq">–°–∏—Å—Ç–µ–º–∞: { 3 = 2k + b ; 7 = 5k + b }</div>
            <div id="coeff">k = 1.333 , b = 0.333</div>
            <div id="equation">–£—Ä–∞–≤–Ω–µ–Ω–∏–µ: y = 1.333 x + 0.333</div>
        </div>

        <canvas id="graphCanvas" width="450" height="450"></canvas>
        <div class="info">‚óè –ö—Ä–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏ ‚Äî –∑–∞–¥–∞–Ω–Ω—ã–µ, —Å–∏–Ω—è—è –ª–∏–Ω–∏—è ‚Äî –ø—Ä—è–º–∞—è</div>
    </div>

    <script>
        const x1Input = document.getElementById('x1');
        const y1Input = document.getElementById('y1');
        const x2Input = document.getElementById('x2');
        const y2Input = document.getElementById('y2');
        const generalDiv = document.getElementById('general');
        const point1Span = document.getElementById('point1');
        const point2Span = document.getElementById('point2');
        const systemDiv = document.getElementById('systemEq');
        const coeffDiv = document.getElementById('coeff');
        const equationDiv = document.getElementById('equation');
        const canvas = document.getElementById('graphCanvas');
        const ctx = canvas.getContext('2d');
        const width = 450, height = 450;

        function formatNumber(num) {
            return Math.abs(num) < 0.001 ? '0' : num.toFixed(3);
        }

        function drawGridAndAxes(xMin, xMax, yMin, yMax) {
            ctx.clearRect(0, 0, width, height);
            // —Å–µ—Ç–∫–∞
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = 0.6;
            for (let i = 0; i <= 10; i++) {
                let x = xMin + i * (xMax - xMin) / 10;
                let y = yMin + i * (yMax - yMin) / 10;
                let sx = (x - xMin) / (xMax - xMin) * width;
                let sy = height - (y - yMin) / (yMax - yMin) * height;
                ctx.beginPath();
                ctx.moveTo(sx, 0);
                ctx.lineTo(sx, height);
                ctx.strokeStyle = '#e2e8f0';
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(0, sy);
                ctx.lineTo(width, sy);
                ctx.stroke();
            }
            // –æ—Å–∏
            ctx.strokeStyle = '#1e293b';
            ctx.lineWidth = 2;
            ctx.beginPath();
            if (xMin <= 0 && xMax >= 0) {
                let zeroX = (0 - xMin) / (xMax - xMin) * width;
                ctx.moveTo(zeroX, 0);
                ctx.lineTo(zeroX, height);
            }
            if (yMin <= 0 && yMax >= 0) {
                let zeroY = height - (0 - yMin) / (yMax - yMin) * height;
                ctx.moveTo(0, zeroY);
                ctx.lineTo(width, zeroY);
            }
            ctx.stroke();
        }

        function plot(x1, y1, x2, y2, k, b, isVertical) {
            let xMin = Math.min(x1, x2);
            let xMax = Math.max(x1, x2);
            let yMin = Math.min(y1, y2);
            let yMax = Math.max(y1, y2);
            let dx = (xMax - xMin) || 1;
            let dy = (yMax - yMin) || 1;
            xMin -= dx * 0.3;
            xMax += dx * 0.3;
            yMin -= dy * 0.3;
            yMax += dy * 0.3;
            if (Math.abs(xMin - xMax) < 1e-10) { xMin -= 1; xMax += 1; }
            if (Math.abs(yMin - yMax) < 1e-10) { yMin -= 1; yMax += 1; }

            drawGridAndAxes(xMin, xMax, yMin, yMax);

            // –ø—Ä—è–º–∞—è
            ctx.strokeStyle = '#2563eb';
            ctx.lineWidth = 3;
            ctx.beginPath();
            if (isVertical) {
                let sx = (x1 - xMin) / (xMax - xMin) * width;
                ctx.moveTo(sx, 0);
                ctx.lineTo(sx, height);
            } else {
                let xStart = xMin;
                let xEnd = xMax;
                let yStart = k * xStart + b;
                let yEnd = k * xEnd + b;
                let sx1 = (xStart - xMin) / (xMax - xMin) * width;
                let sy1 = height - (yStart - yMin) / (yMax - yMin) * height;
                let sx2 = (xEnd - xMin) / (xMax - xMin) * width;
                let sy2 = height - (yEnd - yMin) / (yMax - yMin) * height;
                ctx.moveTo(sx1, sy1);
                ctx.lineTo(sx2, sy2);
            }
            ctx.stroke();

            function drawPoint(x, y, color) {
                let sx = (x - xMin) / (xMax - xMin) * width;
                let sy = height - (y - yMin) / (yMax - yMin) * height;
                ctx.beginPath();
                ctx.fillStyle = color;
                ctx.arc(sx, sy, 6, 0, 2 * Math.PI);
                ctx.fill();
                ctx.strokeStyle = '#0f172a';
                ctx.lineWidth = 1.5;
                ctx.stroke();
            }
            drawPoint(x1, y1, '#ef4444');
            drawPoint(x2, y2, '#ef4444');
        }

        function update() {
            let x1 = parseFloat(x1Input.value);
            let y1 = parseFloat(y1Input.value);
            let x2 = parseFloat(x2Input.value);
            let y2 = parseFloat(y2Input.value);

            if ([x1, y1, x2, y2].some(isNaN)) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —á–∏—Å–ª–∞–º–∏');
                return;
            }

            // –û–±—â–∏–π –≤–∏–¥
            generalDiv.innerHTML = '–£—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä—è–º–æ–π –≤ –æ–±—â–µ–º –≤–∏–¥–µ: y = k¬∑x + b';

            // –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ—á–µ–∫
            point1Span.innerHTML = `y‚ÇÅ = k¬∑x‚ÇÅ + b  ‚Üí  ${y1} = k¬∑${x1} + b`;
            point2Span.innerHTML = `y‚ÇÇ = k¬∑x‚ÇÇ + b  ‚Üí  ${y2} = k¬∑${x2} + b`;

            // –°–∏—Å—Ç–µ–º–∞
            systemDiv.innerHTML = `–°–∏—Å—Ç–µ–º–∞: { ${y1} = ${x1}k + b ; ${y2} = ${x2}k + b }`;

            // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ k –∏ b
            let isVertical = Math.abs(x2 - x1) < 1e-12;
            let k, b;
            if (isVertical) {
                k = '–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
                b = '–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
                coeffDiv.innerHTML = `–ü—Ä—è–º–∞—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞, k –∏ b –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã.`;
                equationDiv.innerHTML = `–£—Ä–∞–≤–Ω–µ–Ω–∏–µ: x = ${x1.toFixed(3)}`;
            } else {
                k = (y2 - y1) / (x2 - x1);
                b = y1 - k * x1;
                coeffDiv.innerHTML = `k = ${formatNumber(k)} , b = ${formatNumber(b)}`;
                let sign = b >= 0 ? '+' : '-';
                equationDiv.innerHTML = `–£—Ä–∞–≤–Ω–µ–Ω–∏–µ: y = ${formatNumber(k)}x ${sign} ${formatNumber(Math.abs(b))}`;
            }

            // –ì—Ä–∞—Ñ–∏–∫
            plot(x1, y1, x2, y2, k, b, isVertical);
        }

        document.getElementById('calcBtn').addEventListener('click', update);
        window.onload = update;
    </script>
</body>
</html>