<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü—Ä—è–º–∞—è —á–µ—Ä–µ–∑ –¥–≤–µ —Ç–æ—á–∫–∏ (–¥—Ä–æ–±–∏, –≥—Ä–∞—Ñ–∏–∫ —Å–ø—Ä–∞–≤–∞)</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: #f1f5f9;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 16px;
        }
        .main-panel {
            display: flex;
            background-color: white;
            border-radius: 32px;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
            max-width: 1300px;
            width: 100%;
            overflow: hidden;
        }
        .left {
            flex: 1.1;
            padding: 32px 28px;
            background: white;
            overflow-y: auto;
            max-height: 95vh;
        }
        .right {
            flex: 1;
            background: #f8fafc;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
            border-left: 2px solid #e2e8f0;
        }
        h2 {
            margin: 0 0 24px 0;
            color: #0b1e33;
            font-weight: 700;
            font-size: 1.9rem;
            border-left: 8px solid #6366f1;
            padding-left: 20px;
        }
        .points {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .point {
            background-color: #f9fbfd;
            border-radius: 20px;
            padding: 22px;
            flex: 1;
            min-width: 200px;
            border: 1px solid #dbe7f2;
            box-shadow: 0 4px 10px rgba(0,0,0,0.02);
        }
        .point h3 {
            margin: 0 0 18px;
            color: #1e3a5f;
            font-weight: 600;
            font-size: 1.3rem;
        }
        .point label {
            display: block;
            margin: 14px 0;
            color: #2c3e50;
            font-weight: 500;
        }
        .point input {
            width: 100px;
            padding: 10px 14px;
            border: 2px solid #cbd5e1;
            border-radius: 14px;
            font-size: 1rem;
            margin-left: 12px;
            transition: border 0.2s;
        }
        .point input:focus {
            border-color: #6366f1;
            outline: none;
        }
        button {
            background: linear-gradient(145deg, #6366f1, #4f46e5);
            color: white;
            border: none;
            border-radius: 40px;
            padding: 16px 32px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            display: block;
            margin: 0 0 30px 0;
            box-shadow: 0 10px 20px rgba(99,102,241,0.3);
            transition: transform 0.1s, box-shadow 0.2s;
            width: fit-content;
        }
        button:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 25px rgba(99,102,241,0.4);
        }
        .result {
            background-color: #ffffff;
            border-radius: 24px;
            padding: 24px;
            margin: 20px 0 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            border: 2px solid #e0e7ff;
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.02);
        }
        .result > div {
            margin: 16px 0;
            line-height: 1.7;
        }
        .fraction {
            display: inline-block;
            text-align: center;
            vertical-align: middle;
            font-weight: 600;
            color: #0b1e33;
        }
        .fraction > span {
            display: block;
            padding: 0 4px;
        }
        .fraction > span:first-child {
            border-bottom: 2px solid #1e293b;
        }
        canvas {
            border: 2px solid #d9e2ef;
            border-radius: 24px;
            display: block;
            background-color: #ffffff;
            width: 100%;
            height: auto;
            max-width: 550px;
            box-shadow: 0 8px 18px rgba(0,0,0,0.08);
        }
        .info {
            color: #4b5563;
            font-size: 0.9rem;
            text-align: center;
            margin-top: 16px;
        }
        .label {
            color: #2d3c53;
            font-weight: 600;
            margin-right: 10px;
            font-size: 1rem;
        }
        .right-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="main-panel">
        <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨: –í–°–ï –í–´–ß–ò–°–õ–ï–ù–ò–Ø -->
        <div class="left">
            <h2>‚úèÔ∏è –ü—Ä—è–º–∞—è –≤ –¥—Ä–æ–±—è—Ö</h2>
            <div class="points">
                <div class="point">
                    <h3>üî¥ –¢–æ—á–∫–∞ A</h3>
                    <label>x‚ÇÅ: <input type="number" id="x1" value="1" step="any"></label>
                    <label>y‚ÇÅ: <input type="number" id="y1" value="2" step="any"></label>
                </div>
                <div class="point">
                    <h3>üîµ –¢–æ—á–∫–∞ B</h3>
                    <label>x‚ÇÇ: <input type="number" id="x2" value="4" step="any"></label>
                    <label>y‚ÇÇ: <input type="number" id="y2" value="5" step="any"></label>
                </div>
            </div>
            <button id="calcBtn">‚ü≥ –í–´–ß–ò–°–õ–ò–¢–¨ –í –î–†–û–ë–Ø–•</button>

            <div class="result" id="result">
                <div><span class="label">1Ô∏è‚É£ –û–±—â–∏–π –≤–∏–¥:</span> y = k¬∑x + b</div>
                <div><span class="label">2Ô∏è‚É£ –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π:</span><br>
                    <span id="sys1">y‚ÇÅ = k¬∑x‚ÇÅ + b  ‚Üí  2 = k¬∑1 + b</span><br>
                    <span id="sys2">y‚ÇÇ = k¬∑x‚ÇÇ + b  ‚Üí  5 = k¬∑4 + b</span>
                </div>
                <div><span class="label">3Ô∏è‚É£ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–¥—Ä–æ–±–∏):</span><br>
                    k = <span id="kVal" class="fraction">1/1</span><br>
                    b = <span id="bVal" class="fraction">1/1</span>
                </div>
                <div><span class="label">4Ô∏è‚É£ –£—Ä–∞–≤–Ω–µ–Ω–∏–µ:</span> <span id="eqText">y = 1x + 1</span></div>
            </div>
            <div class="info">‚óè –ö—Ä–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏ ‚Äî –∑–∞–¥–∞–Ω–Ω—ã–µ, —Å–∏–Ω—è—è –ª–∏–Ω–∏—è ‚Äî –ø—Ä—è–º–∞—è</div>
        </div>

        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨: –¢–û–õ–¨–ö–û –ì–†–ê–§–ò–ö -->
        <div class="right">
            <div class="right-content">
                <canvas id="graphCanvas" width="550" height="550"></canvas>
            </div>
        </div>
    </div>

    <script>
        // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –î–†–û–ë–ï–ô ==========
        function gcd(a, b) {
            a = Math.abs(a);
            b = Math.abs(b);
            while (b) { let t = b; b = a % b; a = t; }
            return a;
        }

        class Fraction {
            constructor(num, den = 1) {
                if (den === 0) throw new Error("Denominator zero");
                let sign = (num < 0) ^ (den < 0) ? -1 : 1;
                num = Math.abs(num);
                den = Math.abs(den);
                let g = gcd(num, den);
                this.num = sign * (num / g);
                this.den = den / g;
            }

            add(other) {
                return new Fraction(
                    this.num * other.den + other.num * this.den,
                    this.den * other.den
                );
            }
            sub(other) {
                return new Fraction(
                    this.num * other.den - other.num * this.den,
                    this.den * other.den
                );
            }
            mul(other) {
                return new Fraction(this.num * other.num, this.den * other.den);
            }
            div(other) {
                return new Fraction(this.num * other.den, this.den * other.num);
            }
            toFloat() { return this.num / this.den; }
            toString() {
                if (this.den === 1) return `${this.num}`;
                return `${this.num}/${this.den}`;
            }
        }

        function toFraction(value) {
            if (Number.isInteger(value)) return new Fraction(value, 1);
            const eps = 1e-6;
            for (let den = 1; den <= 2000; den++) {
                let num = Math.round(value * den);
                if (Math.abs(value - num / den) < eps) {
                    return new Fraction(num, den);
                }
            }
            return new Fraction(Math.round(value * 1e6), 1e6);
        }

        function formatFraction(frac) {
            if (frac.den === 1) return `${frac.num}`;
            return `${frac.num}/${frac.den}`;
        }

        // ========== –ü–û–õ–£–ß–ï–ù–ò–ï –î–ê–ù–ù–´–• –ò –í–´–ß–ò–°–õ–ï–ù–ò–Ø ==========
        function calculate() {
            let x1 = parseFloat(document.getElementById('x1').value);
            let y1 = parseFloat(document.getElementById('y1').value);
            let x2 = parseFloat(document.getElementById('x2').value);
            let y2 = parseFloat(document.getElementById('y2').value);

            if ([x1, y1, x2, y2].some(isNaN)) {
                alert('–í–≤–µ–¥–∏—Ç–µ –≤—Å–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã');
                return;
            }

            // –î—Ä–æ–±–∏ –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
            let fx1 = toFraction(x1);
            let fy1 = toFraction(y1);
            let fx2 = toFraction(x2);
            let fy2 = toFraction(y2);

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É
            document.getElementById('sys1').innerHTML = `y‚ÇÅ = k¬∑x‚ÇÅ + b  ‚Üí  ${fy1.toString()} = k¬∑${fx1.toString()} + b`;
            document.getElementById('sys2').innerHTML = `y‚ÇÇ = k¬∑x‚ÇÇ + b  ‚Üí  ${fy2.toString()} = k¬∑${fx2.toString()} + b`;

            // –†–∞–∑–Ω–æ—Å—Ç—å –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ–π –¥–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
            let dx = fx2.sub(fx1);
            let isVertical = (dx.num === 0);

            let k, b;
            if (isVertical) {
                document.getElementById('kVal').innerHTML = '–Ω–µ –æ–ø—Ä.';
                document.getElementById('bVal').innerHTML = '–Ω–µ –æ–ø—Ä.';
                document.getElementById('eqText').innerHTML = `x = ${fx1.toString()}`;
            } else {
                // –Ø–≤–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ k = (y2 - y1)/(x2 - x1)
                let dy = fy2.sub(fy1);
                k = dy.div(dx);

                // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ b = y2 - k * x2
                let kx2 = k.mul(fx2);
                b = fy2.sub(kx2);

                document.getElementById('kVal').innerHTML = formatFraction(k);
                document.getElementById('bVal').innerHTML = formatFraction(b);

                // –§–æ—Ä–º–∏—Ä—É–µ–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä–æ–±—è–º–∏
                let kStr = formatFraction(k);
                let bStr = formatFraction(b);
                if (kStr === '1') kStr = '';
                if (kStr === '-1') kStr = '-';
                let sign = (b.num >= 0) ? '+' : '-';
                let bAbs = formatFraction(new Fraction(Math.abs(b.num), b.den));
                if (bAbs === '0') {
                    document.getElementById('eqText').innerHTML = `y = ${kStr}x`;
                } else {
                    document.getElementById('eqText').innerHTML = `y = ${kStr}x ${sign} ${bAbs}`;
                }
            }

            // –†–∏—Å—É–µ–º –≥—Ä–∞—Ñ–∏–∫
            drawGraph(x1, y1, x2, y2, isVertical ? null : k.toFloat(), isVertical ? null : b.toFloat(), isVertical, x1);
        }

        // ========== –û–¢–†–ò–°–û–í–ö–ê –ì–†–ê–§–ò–ö–ê ==========
        function drawGraph(x1, y1, x2, y2, k, b, isVertical, vertX) {
            const canvas = document.getElementById('graphCanvas');
            const ctx = canvas.getContext('2d');
            const w = 550, h = 550;

            let xMin = Math.min(x1, x2);
            let xMax = Math.max(x1, x2);
            let yMin = Math.min(y1, y2);
            let yMax = Math.max(y1, y2);
            let dx = (xMax - xMin) || 1;
            let dy = (yMax - yMin) || 1;
            xMin -= dx * 0.3;
            xMax += dx * 0.3;
            yMin -= dy * 0.3;
            yMax += dy * 0.3;
            if (Math.abs(xMin - xMax) < 1e-10) { xMin -= 1; xMax += 1; }
            if (Math.abs(yMin - yMax) < 1e-10) { yMin -= 1; yMax += 1; }

            ctx.clearRect(0, 0, w, h);

            // –°–µ—Ç–∫–∞
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = 0.8;
            for (let i = 0; i <= 10; i++) {
                let x = xMin + i * (xMax - xMin) / 10;
                let y = yMin + i * (yMax - yMin) / 10;
                let sx = (x - xMin) / (xMax - xMin) * w;
                let sy = h - (y - yMin) / (yMax - yMin) * h;
                ctx.beginPath();
                ctx.moveTo(sx, 0);
                ctx.lineTo(sx, h);
                ctx.strokeStyle = '#e2e8f0';
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(0, sy);
                ctx.lineTo(w, sy);
                ctx.stroke();
            }

            // –û—Å–∏
            ctx.strokeStyle = '#1e293b';
            ctx.lineWidth = 3;
            ctx.beginPath();
            if (xMin <= 0 && xMax >= 0) {
                let zeroX = (0 - xMin) / (xMax - xMin) * w;
                ctx.moveTo(zeroX, 0);
                ctx.lineTo(zeroX, h);
            }
            if (yMin <= 0 && yMax >= 0) {
                let zeroY = h - (0 - yMin) / (yMax - yMin) * h;
                ctx.moveTo(0, zeroY);
                ctx.lineTo(w, zeroY);
            }
            ctx.stroke();

            // –ü—Ä—è–º–∞—è
            ctx.strokeStyle = '#2563eb';
            ctx.lineWidth = 3.5;
            ctx.beginPath();
            if (isVertical) {
                let sx = (vertX - xMin) / (xMax - xMin) * w;
                ctx.moveTo(sx, 0);
                ctx.lineTo(sx, h);
            } else {
                let xStart = xMin;
                let xEnd = xMax;
                let yStart = k * xStart + b;
                let yEnd = k * xEnd + b;
                let sx1 = (xStart - xMin) / (xMax - xMin) * w;
                let sy1 = h - (yStart - yMin) / (yMax - yMin) * h;
                let sx2 = (xEnd - xMin) / (xMax - xMin) * w;
                let sy2 = h - (yEnd - yMin) / (yMax - yMin) * h;
                ctx.moveTo(sx1, sy1);
                ctx.lineTo(sx2, sy2);
            }
            ctx.stroke();

            // –¢–æ—á–∫–∏
            function drawPoint(x, y, color) {
                let sx = (x - xMin) / (xMax - xMin) * w;
                let sy = h - (y - yMin) / (yMax - yMin) * h;
                ctx.beginPath();
                ctx.fillStyle = color;
                ctx.arc(sx, sy, 8, 0, 2 * Math.PI);
                ctx.fill();
                ctx.strokeStyle = '#0f172a';
                ctx.lineWidth = 2;
                ctx.stroke();
            }
            drawPoint(x1, y1, '#ef4444');
            drawPoint(x2, y2, '#ef4444');
        }

        document.getElementById('calcBtn').addEventListener('click', calculate);
        window.onload = calculate;
    </script>
</body>
</html>